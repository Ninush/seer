models <- dplyr::recode(models, "ARIMA(0,0,0) with non-zero mean"="wn")
models <- dplyr::recode(models, "ARIMA(0,0,0) with zero mean"="wn")
models <- dplyr::recode(models, "ARIMA(0,0,0)(0,1,0)[4]"="snaive")
models <- dplyr::recode(models, "ARIMA(0,0,0)(0,1,0)[12]"="snaive")
# First identify the sarima models and rename them as "SARIMA"
toMatch_frequency <- c("[12]", "[4]")
index_sarima <- grepl(paste0(gsub("(\\[)","\\\\[", toMatch_frequency), collapse = "|"), models)
df1 <- data.frame(models=models, ind_sarima = index_sarima)
df1$models <- as.character(df1$models)
models <- ifelse(df1$ind_sarima == TRUE, "SARIMA", df1$models)
###Here we have choosen the separator as space(\\s), parenthesis ( \\( and \\) ) and commas (,)
df <- data.frame(stringr::str_split_fixed(models,"\\s|\\(|\\)|,",n=5))
#Rename basis the question, into follwing:
#p is the number of autoregressive terms(AR)
#d is the number of nonseasonal differences needed for stationarity(MA)
#q is the number of lagged forecast errors in the prediction equation(order of differencing)
names(df) <- c("Model","p","d","q","outcome")
# If the outcome column contains all "" stop the code from here
if(length(which(nchar(trimws(df$outcome))==0))==dim(df)[1]){
df <- dplyr::select(df, c("Model", "p", "d", "q"))
df$Model <- as.character(df$Model)
return(df)}
#cleaning the outcome column by replacing spaces and dashes with underscores
df$outcome_ <- gsub("\\s|-","_",trimws(df$outcome))
#using model.matrix to calculate the dummies for drift and non zero mean,
#for the value of 1 meaning True and 0 meaning False
dummy_mat <- data.frame(model.matrix(~outcome_-1,data=df))
df_final <- data.frame(df[,1:4],dummy_mat)
df_final <- df_final[,c("Model", "p", "d", "q", "outcome_with_drift", "outcome_with_non_zero_mean")]
df_final$Model <- as.character(df_final$Model)
return(df_final)
}
library(Mcomp)
tslist <- list(M3[[1]], M3[[2]], M3[[3]], M3[[4]], M3[[5]])
acc_set <- fcast_accuracy(tslist=tslist,
models= c("arima","ets","rw","rwd", "theta", "nn", "snaive", "mstl"),
database ="M3", cal_MASE, h=6)
fea_set <- cal_features(tslist, database="M3", h=6)
prepare_traingset(acc_set, fea_set)
accuracy_set <- acc_set
feature_set <- fea_set
accuracy_measures <- as.data.frame(accuracy_set$accuracy)
minimum_accuracy <- apply(accuracy_measures,1,min)
inf_indices <- which(minimum_accuracy==Inf)
na_indices <- which(is.na(minimum_accuracy)==TRUE)
rmv_indices <- c(inf_indices, na_indices)
accuracy_measures$ARIMA_name <- as.character(accuracy_set$ARIMA)
accuracy_measures$ETS_name <- as.character(accuracy_set$ETS)
training_set <- dplyr::bind_cols(feature_set, accuracy_measures)
training_set <- training_set[-rmv_indices, ]
# find the classlabel corresponds to minimum
colnames_accuracyMatrix <- colnames(accuracy_set$accuracy)
df_accuracy <- dplyr::select(training_set, colnames_accuracyMatrix)
training_set$min_label <- as.character(seer::classlabel(df_accuracy))
training_set$model_names <- ifelse(training_set$min_label == "arima", training_set$ARIMA_name, training_set$min_label)
training_set$model_names <- ifelse(training_set$min_label == "ets", training_set$ETS_name, training_set$min_label)
training_set$model_names <- as.character(training_set$model_names)
# classify labe names
df_modnames <- split_names(training_set$model_names)
df_modnames
training_set$model_names
colnames_accuracyMatrix
classlabel <- classify_labels(df_modnames)
colnames_accuracyMatrix
df_accuracy
accuracy_measures
training_set <- dplyr::bind_cols(feature_set, accuracy_measures)
training_set
training_set <- training_set[-rmv_indices, ]
training_set
rmv_indices
is.null(rmv_indices)
inf_indices
which(minimum_accuracy==Inf)
length(which(minimum_accuracy==Inf))
length(rmv_indices)
accuracy_measures <- as.data.frame(accuracy_set$accuracy)
minimum_accuracy <- apply(accuracy_measures,1,min)
inf_indices <- which(minimum_accuracy==Inf)
na_indices <- which(is.na(minimum_accuracy)==TRUE)
rmv_indices <- c(inf_indices, na_indices)
accuracy_measures$ARIMA_name <- as.character(accuracy_set$ARIMA)
accuracy_measures$ETS_name <- as.character(accuracy_set$ETS)
training_set <- dplyr::bind_cols(feature_set, accuracy_measures)
if(rmv_indices!=0) {training_set <- training_set[-rmv_indices, ]}
if(length(rmv_indices)!=0) {training_set <- training_set[-rmv_indices, ]}
training_set
# find the classlabel corresponds to minimum
colnames_accuracyMatrix <- colnames(accuracy_set$accuracy)
df_accuracy <- dplyr::select(training_set, colnames_accuracyMatrix)
training_set$min_label <- as.character(seer::classlabel(df_accuracy))
training_set$model_names <- ifelse(training_set$min_label == "arima", training_set$ARIMA_name, training_set$min_label)
training_set$model_names <- ifelse(training_set$min_label == "ets", training_set$ETS_name, training_set$min_label)
training_set$model_names <- as.character(training_set$model_names)
# classify labe names
df_modnames <- split_names(training_set$model_names)
classlabel <- classify_labels(df_modnames)
training_set$classlabels <- classlabel
# extract complete cases only
training_set <- training_set[complete.cases(training_set),]
training_set
library(seer)
names(fea_set)
#' preparation of training set
#'
#' Preparation of a training set for random forest training
#' @param accuracy_set output from the fcast_accuracy
#' @param feature_set output from the cal_features
#' @return dataframe consisting features and classlabels
#' @export
prepare_trainingset <- function(accuracy_set, feature_set){
accuracy_measures <- as.data.frame(accuracy_set$accuracy)
minimum_accuracy <- apply(accuracy_measures,1,min)
inf_indices <- which(minimum_accuracy==Inf)
na_indices <- which(is.na(minimum_accuracy)==TRUE)
rmv_indices <- c(inf_indices, na_indices)
accuracy_measures$ARIMA_name <- as.character(accuracy_set$ARIMA)
accuracy_measures$ETS_name <- as.character(accuracy_set$ETS)
training_set <- dplyr::bind_cols(feature_set, accuracy_measures)
if(length(rmv_indices)!=0) {training_set <- training_set[-rmv_indices, ]}
# find the classlabel corresponds to minimum
colnames_accuracyMatrix <- colnames(accuracy_set$accuracy)
df_accuracy <- dplyr::select(training_set, colnames_accuracyMatrix)
training_set$min_label <- as.character(seer::classlabel(df_accuracy))
training_set$model_names <- ifelse(training_set$min_label == "arima", training_set$ARIMA_name, training_set$min_label)
training_set$model_names <- ifelse(training_set$min_label == "ets", training_set$ETS_name, training_set$min_label)
training_set$model_names <- as.character(training_set$model_names)
# classify labe names
df_modnames <- split_names(training_set$model_names)
classlabel <- classify_labels(df_modnames)
training_set$classlabels <- classlabel
# extract complete cases only
training_set <- training_set[complete.cases(training_set),]
training_set <- dplyr::select(training_set, c(colnames(feature_set), classlabels))
return(training_set)
}
#'@example
library(Mcomp)
tslist <- list(M3[[1]], M3[[2]], M3[[3]], M3[[4]], M3[[5]])
acc_set <- fcast_accuracy(tslist=tslist,
models= c("arima","ets","rw","rwd", "theta", "nn", "snaive", "mstl"),
database ="M3", cal_MASE, h=6)
fea_set <- cal_features(tslist, database="M3", h=6)
prepare_trainingset(acc_set, fea_set)
training_set
colnames(feature_set)
training_set <- dplyr::select(training_set, c(colnames(feature_set), "classlabels"))
return(training_set)
#' preparation of training set
#'
#' Preparation of a training set for random forest training
#' @param accuracy_set output from the fcast_accuracy
#' @param feature_set output from the cal_features
#' @return dataframe consisting features and classlabels
#' @export
prepare_trainingset <- function(accuracy_set, feature_set){
accuracy_measures <- as.data.frame(accuracy_set$accuracy)
minimum_accuracy <- apply(accuracy_measures,1,min)
inf_indices <- which(minimum_accuracy==Inf)
na_indices <- which(is.na(minimum_accuracy)==TRUE)
rmv_indices <- c(inf_indices, na_indices)
accuracy_measures$ARIMA_name <- as.character(accuracy_set$ARIMA)
accuracy_measures$ETS_name <- as.character(accuracy_set$ETS)
training_set <- dplyr::bind_cols(feature_set, accuracy_measures)
if(length(rmv_indices)!=0) {training_set <- training_set[-rmv_indices, ]}
# find the classlabel corresponds to minimum
colnames_accuracyMatrix <- colnames(accuracy_set$accuracy)
df_accuracy <- dplyr::select(training_set, colnames_accuracyMatrix)
training_set$min_label <- as.character(seer::classlabel(df_accuracy))
training_set$model_names <- ifelse(training_set$min_label == "arima", training_set$ARIMA_name, training_set$min_label)
training_set$model_names <- ifelse(training_set$min_label == "ets", training_set$ETS_name, training_set$min_label)
training_set$model_names <- as.character(training_set$model_names)
# classify labe names
df_modnames <- split_names(training_set$model_names)
classlabel <- classify_labels(df_modnames)
training_set$classlabels <- classlabel
# extract complete cases only
training_set <- training_set[complete.cases(training_set),]
training_set <- dplyr::select(training_set, c(colnames(feature_set), "classlabels"))
return(training_set)
}
#'@example
library(Mcomp)
tslist <- list(M3[[1]], M3[[2]], M3[[3]], M3[[4]], M3[[5]])
acc_set <- fcast_accuracy(tslist=tslist,
models= c("arima","ets","rw","rwd", "theta", "nn", "snaive", "mstl"),
database ="M3", cal_MASE, h=6)
fea_set <- cal_features(tslist, database="M3", h=6)
prepare_trainingset(acc_set, fea_set)
a <- prepare_trainingset(acc_set, fea_set)
dim(a)
#' preparation of training set
#'
#' Preparation of a training set for random forest training
#' @param accuracy_set output from the fcast_accuracy
#' @param feature_set output from the cal_features
#' @return dataframe consisting features and classlabels
#' @export
prepare_trainingset <- function(accuracy_set, feature_set){
accuracy_measures <- as.data.frame(accuracy_set$accuracy)
minimum_accuracy <- apply(accuracy_measures,1,min)
inf_indices <- which(minimum_accuracy==Inf)
na_indices <- which(is.na(minimum_accuracy)==TRUE)
rmv_indices <- c(inf_indices, na_indices)
accuracy_measures$ARIMA_name <- as.character(accuracy_set$ARIMA)
accuracy_measures$ETS_name <- as.character(accuracy_set$ETS)
training_set <- dplyr::bind_cols(feature_set, accuracy_measures)
if(length(rmv_indices)!=0) {training_set <- training_set[-rmv_indices, ]}
# find the classlabel corresponds to minimum
colnames_accuracyMatrix <- colnames(accuracy_set$accuracy)
df_accuracy <- dplyr::select(training_set, colnames_accuracyMatrix)
training_set$min_label <- as.character(seer::classlabel(df_accuracy))
training_set$model_names <- ifelse(training_set$min_label == "arima", training_set$ARIMA_name, training_set$min_label)
training_set$model_names <- ifelse(training_set$min_label == "ets", training_set$ETS_name, training_set$min_label)
training_set$model_names <- as.character(training_set$model_names)
# classify labe names
df_modnames <- split_names(training_set$model_names)
classlabel <- classify_labels(df_modnames)
training_set$classlabels <- classlabel
# extract complete cases only
training_set <- training_set[complete.cases(training_set),]
models <- data.frame(training_set$ARIMA_names, training_set$ETS_names, training_set$min_label, training_set$model_label)
training_set <- dplyr::select(training_set, c(colnames(feature_set), "classlabels"))
train <- list(models, training_set)
return(train)
}
#'@example
library(Mcomp)
tslist <- list(M3[[1]], M3[[2]], M3[[3]], M3[[4]], M3[[5]])
acc_set <- fcast_accuracy(tslist=tslist,
models= c("arima","ets","rw","rwd", "theta", "nn", "snaive", "mstl"),
database ="M3", cal_MASE, h=6)
fea_set <- cal_features(tslist, database="M3", h=6)
prepare_trainingset(acc_set, fea_set)
accuracy_measures <- as.data.frame(accuracy_set$accuracy)
minimum_accuracy <- apply(accuracy_measures,1,min)
inf_indices <- which(minimum_accuracy==Inf)
na_indices <- which(is.na(minimum_accuracy)==TRUE)
rmv_indices <- c(inf_indices, na_indices)
accuracy_measures$ARIMA_name <- as.character(accuracy_set$ARIMA)
accuracy_measures$ETS_name <- as.character(accuracy_set$ETS)
training_set <- dplyr::bind_cols(feature_set, accuracy_measures)
if(length(rmv_indices)!=0) {training_set <- training_set[-rmv_indices, ]}
# find the classlabel corresponds to minimum
colnames_accuracyMatrix <- colnames(accuracy_set$accuracy)
df_accuracy <- dplyr::select(training_set, colnames_accuracyMatrix)
training_set$min_label <- as.character(seer::classlabel(df_accuracy))
training_set$model_names <- ifelse(training_set$min_label == "arima", training_set$ARIMA_name, training_set$min_label)
training_set$model_names <- ifelse(training_set$min_label == "ets", training_set$ETS_name, training_set$min_label)
training_set$model_names <- as.character(training_set$model_names)
# classify labe names
df_modnames <- split_names(training_set$model_names)
classlabel <- classify_labels(df_modnames)
training_set$classlabels <- classlabel
# extract complete cases only
training_set <- training_set[complete.cases(training_set),]
training_set$ARIMA_names
training_set
#' preparation of training set
#'
#' Preparation of a training set for random forest training
#' @param accuracy_set output from the fcast_accuracy
#' @param feature_set output from the cal_features
#' @return dataframe consisting features and classlabels
#' @export
prepare_trainingset <- function(accuracy_set, feature_set){
accuracy_measures <- as.data.frame(accuracy_set$accuracy)
minimum_accuracy <- apply(accuracy_measures,1,min)
inf_indices <- which(minimum_accuracy==Inf)
na_indices <- which(is.na(minimum_accuracy)==TRUE)
rmv_indices <- c(inf_indices, na_indices)
accuracy_measures$ARIMA_name <- as.character(accuracy_set$ARIMA)
accuracy_measures$ETS_name <- as.character(accuracy_set$ETS)
training_set <- dplyr::bind_cols(feature_set, accuracy_measures)
if(length(rmv_indices)!=0) {training_set <- training_set[-rmv_indices, ]}
# find the classlabel corresponds to minimum
colnames_accuracyMatrix <- colnames(accuracy_set$accuracy)
df_accuracy <- dplyr::select(training_set, colnames_accuracyMatrix)
training_set$min_label <- as.character(seer::classlabel(df_accuracy))
training_set$model_names <- ifelse(training_set$min_label == "arima", training_set$ARIMA_name, training_set$min_label)
training_set$model_names <- ifelse(training_set$min_label == "ets", training_set$ETS_name, training_set$min_label)
training_set$model_names <- as.character(training_set$model_names)
# classify labe names
df_modnames <- split_names(training_set$model_names)
classlabel <- classify_labels(df_modnames)
training_set$classlabels <- classlabel
# extract complete cases only
training_set <- training_set[complete.cases(training_set),]
models <- data.frame(training_set$ARIMA_name, training_set$ETS_name, training_set$min_label, training_set$model_names)
training_set <- dplyr::select(training_set, c(colnames(feature_set), "classlabels"))
train <- list(models, training_set)
return(train)
}
#'@example
library(Mcomp)
tslist <- list(M3[[1]], M3[[2]], M3[[3]], M3[[4]], M3[[5]])
acc_set <- fcast_accuracy(tslist=tslist,
models= c("arima","ets","rw","rwd", "theta", "nn", "snaive", "mstl"),
database ="M3", cal_MASE, h=6)
fea_set <- cal_features(tslist, database="M3", h=6)
prepare_trainingset(acc_set, fea_set)
#' preparation of training set
#'
#' Preparation of a training set for random forest training
#' @param accuracy_set output from the fcast_accuracy
#' @param feature_set output from the cal_features
#' @return dataframe consisting features and classlabels
#' @export
prepare_trainingset <- function(accuracy_set, feature_set){
accuracy_measures <- as.data.frame(accuracy_set$accuracy)
minimum_accuracy <- apply(accuracy_measures,1,min)
inf_indices <- which(minimum_accuracy==Inf)
na_indices <- which(is.na(minimum_accuracy)==TRUE)
rmv_indices <- c(inf_indices, na_indices)
accuracy_measures$ARIMA_name <- as.character(accuracy_set$ARIMA)
accuracy_measures$ETS_name <- as.character(accuracy_set$ETS)
training_set <- dplyr::bind_cols(feature_set, accuracy_measures)
if(length(rmv_indices)!=0) {training_set <- training_set[-rmv_indices, ]}
# find the classlabel corresponds to minimum
colnames_accuracyMatrix <- colnames(accuracy_set$accuracy)
df_accuracy <- dplyr::select(training_set, colnames_accuracyMatrix)
training_set$min_label <- as.character(seer::classlabel(df_accuracy))
training_set$model_names <- ifelse(training_set$min_label == "arima", training_set$ARIMA_name, training_set$min_label)
training_set$model_names <- ifelse(training_set$min_label == "ets", training_set$ETS_name, training_set$min_label)
training_set$model_names <- as.character(training_set$model_names)
# classify labe names
df_modnames <- split_names(training_set$model_names)
classlabel <- classify_labels(df_modnames)
training_set$classlabels <- classlabel
# extract complete cases only
training_set <- training_set[complete.cases(training_set),]
models <- data.frame(training_set$ARIMA_name, training_set$ETS_name, training_set$min_label, training_set$model_names)
training_set <- dplyr::select(training_set, c(colnames(feature_set), "classlabels"))
train <- list(modelinfo=models, trainingset=training_set)
return(train)
}
#'@example
library(Mcomp)
tslist <- list(M3[[1]], M3[[2]], M3[[3]], M3[[4]], M3[[5]])
acc_set <- fcast_accuracy(tslist=tslist,
models= c("arima","ets","rw","rwd", "theta", "nn", "snaive", "mstl"),
database ="M3", cal_MASE, h=6)
fea_set <- cal_features(tslist, database="M3", h=6)
outcome <- prepare_trainingset(acc_set, fea_set)
outcome$training_set
outcome$trainingset
outcome$modelinfo
#' preparation of training set
#'
#' Preparation of a training set for random forest training
#' @param accuracy_set output from the fcast_accuracy
#' @param feature_set output from the cal_features
#' @return dataframe consisting features and classlabels
#' @export
prepare_trainingset <- function(accuracy_set, feature_set){
accuracy_measures <- as.data.frame(accuracy_set$accuracy)
minimum_accuracy <- apply(accuracy_measures,1,min)
inf_indices <- which(minimum_accuracy==Inf)
na_indices <- which(is.na(minimum_accuracy)==TRUE)
rmv_indices <- c(inf_indices, na_indices)
accuracy_measures$ARIMA_name <- as.character(accuracy_set$ARIMA)
accuracy_measures$ETS_name <- as.character(accuracy_set$ETS)
training_set <- dplyr::bind_cols(feature_set, accuracy_measures)
if(length(rmv_indices)!=0) {training_set <- training_set[-rmv_indices, ]}
# find the classlabel corresponds to minimum
colnames_accuracyMatrix <- colnames(accuracy_set$accuracy)
df_accuracy <- dplyr::select(training_set, colnames_accuracyMatrix)
training_set$min_label <- as.character(seer::classlabel(df_accuracy))
training_set$model_names <- ifelse(training_set$min_label == "arima", training_set$ARIMA_name, training_set$min_label)
training_set$model_names <- ifelse(training_set$min_label == "ets", training_set$ETS_name, training_set$min_label)
training_set$model_names <- as.character(training_set$model_names)
# classify labe names
df_modnames <- split_names(training_set$model_names)
classlabel <- classify_labels(df_modnames)
training_set$classlabels <- classlabel
# extract complete cases only
training_set <- training_set[complete.cases(training_set),]
models <- data.frame(ARIMA_name=training_set$ARIMA_name, ETS_name=training_set$ETS_name,
min_label=training_set$min_label, model_names=training_set$model_names)
training_set <- dplyr::select(training_set, c(colnames(feature_set), "classlabels"))
train <- list(modelinfo=models, trainingset=training_set)
return(train)
}
#'@example
library(Mcomp)
tslist <- list(M3[[1]], M3[[2]], M3[[3]], M3[[4]], M3[[5]])
acc_set <- fcast_accuracy(tslist=tslist,
models= c("arima","ets","rw","rwd", "theta", "nn", "snaive", "mstl"),
database ="M3", cal_MASE, h=6)
fea_set <- cal_features(tslist, database="M3", h=6)
outcome <- prepare_trainingset(acc_set, fea_set)
outcome$trainingset
outcome$modelinfo
library(seer)
library(seer)
library(seer)
library(seer)
library(seer)
library(seer)
library(seer)
library(seer)
library(seer)
#' preparation of training set
#'
#' Preparation of a training set for random forest training
#' @param accuracy_set output from the fcast_accuracy
#' @param feature_set output from the cal_features
#' @return dataframe consisting features and classlabels
#' @export
prepare_trainingset <- function(accuracy_set, feature_set){
accuracy_measures <- as.data.frame(accuracy_set$accuracy)
minimum_accuracy <- apply(accuracy_measures,1,min)
inf_indices <- which(minimum_accuracy==Inf)
na_indices <- which(is.na(minimum_accuracy)==TRUE)
rmv_indices <- c(inf_indices, na_indices)
accuracy_measures$ARIMA_name <- as.character(accuracy_set$ARIMA)
accuracy_measures$ETS_name <- as.character(accuracy_set$ETS)
training_set <- dplyr::bind_cols(feature_set, accuracy_measures)
if(length(rmv_indices)!=0) {training_set <- training_set[-rmv_indices, ]}
# find the classlabel corresponds to minimum
colnames_accuracyMatrix <- colnames(accuracy_set$accuracy)
df_accuracy <- dplyr::select(training_set, colnames_accuracyMatrix)
training_set$min_label <- as.character(seer::classlabel(df_accuracy))
training_set$model_names <- ifelse(training_set$min_label == "arima", training_set$ARIMA_name, training_set$min_label)
training_set$model_names <- ifelse(training_set$min_label == "ets", training_set$ETS_name, training_set$model_names)
training_set$model_names <- as.character(training_set$model_names)
# classify labe names
df_modnames <- split_names(training_set$model_names)
classlabel <- classify_labels(df_modnames)
training_set$classlabels <- classlabel
# extract complete cases only
training_set <- training_set[complete.cases(training_set),]
models <- data.frame(ARIMA_name=training_set$ARIMA_name, ETS_name=training_set$ETS_name,
min_label=training_set$min_label, model_names=training_set$model_names)
training_set <- dplyr::select(training_set, c(colnames(feature_set), "classlabels"))
train <- list(modelinfo=models, trainingset=training_set)
return(train)
}
#'@example
library(Mcomp)
tslist <- list(M3[[1]], M3[[2]], M3[[3]], M3[[4]], M3[[5]])
acc_set <- fcast_accuracy(tslist=tslist,
models= c("arima","ets","rw","rwd", "theta", "nn", "snaive", "mstl"),
database ="M3", cal_MASE, h=6)
fea_set <- cal_features(tslist, database="M3", h=6)
library(seer)
library(tsfeatures)
library(Mcomp)
tslist <- list(M3[[1]], M3[[2]], M3[[3]], M3[[4]], M3[[5]])
acc_set <- fcast_accuracy(tslist=tslist,
models= c("arima","ets","rw","rwd", "theta", "nn", "snaive", "mstl"),
database ="M3", cal_MASE, h=6)
fea_set <- cal_features(tslist, database="M3", h=6)
outcome <- prepare_trainingset(acc_set, fea_set)
rm(list=ls())
#' preparation of training set
#'
#' Preparation of a training set for random forest training
#' @param accuracy_set output from the fcast_accuracy
#' @param feature_set output from the cal_features
#' @return dataframe consisting features and classlabels
#' @export
prepare_trainingset <- function(accuracy_set, feature_set){
accuracy_measures <- as.data.frame(accuracy_set$accuracy)
minimum_accuracy <- apply(accuracy_measures,1,min)
inf_indices <- which(minimum_accuracy==Inf)
na_indices <- which(is.na(minimum_accuracy)==TRUE)
rmv_indices <- c(inf_indices, na_indices)
accuracy_measures$ARIMA_name <- as.character(accuracy_set$ARIMA)
accuracy_measures$ETS_name <- as.character(accuracy_set$ETS)
training_set <- dplyr::bind_cols(feature_set, accuracy_measures)
if(length(rmv_indices)!=0) {training_set <- training_set[-rmv_indices, ]}
# find the classlabel corresponds to minimum
colnames_accuracyMatrix <- colnames(accuracy_set$accuracy)
df_accuracy <- dplyr::select(training_set, colnames_accuracyMatrix)
training_set$min_label <- as.character(seer::classlabel(df_accuracy))
training_set$model_names <- ifelse(training_set$min_label == "arima", training_set$ARIMA_name, training_set$min_label)
training_set$model_names <- ifelse(training_set$min_label == "ets", training_set$ETS_name, training_set$model_names)
training_set$model_names <- as.character(training_set$model_names)
# classify labe names
df_modnames <- split_names(training_set$model_names)
classlabel <- classify_labels(df_modnames)
training_set$classlabels <- classlabel
# extract complete cases only
training_set <- training_set[complete.cases(training_set),]
models <- data.frame(ARIMA_name=training_set$ARIMA_name, ETS_name=training_set$ETS_name,
min_label=training_set$min_label, model_names=training_set$model_names)
training_set <- dplyr::select(training_set, c(colnames(feature_set), "classlabels"))
train <- list(modelinfo=models, trainingset=training_set)
return(train)
}
library(seer)
library(tsfeatures)
libary(forecast)
library(forecast)
#'@example
library(Mcomp)
tslist <- list(M3[[1]], M3[[2]], M3[[3]], M3[[4]], M3[[5]])
acc_set <- fcast_accuracy(tslist=tslist,
models= c("arima","ets","rw","rwd", "theta", "nn", "snaive", "mstl"),
database ="M3", cal_MASE, h=6)
fea_set <- cal_features(tslist, database="M3", h=6)
outcome <- prepare_trainingset(acc_set, fea_set)
outcome$trainingset
outcome$modelinfo
library(seer)
library(forecast)
library(seer)
library(seer)
library(randomForest)
?randomForest
library(seer)
